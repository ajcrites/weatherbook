<meta charset=utf-8>
<title>Weatherbook</title>
<link rel=stylesheet type=text/css href=index.css>

<div ng-app=weatherbook ng-cloak>
    <h1>Welcome to Weatherbook</h1>

    <section ng-controller=DirectoryCtrl>
        <nav class=directory>
            <ol>
                <li ng-repeat="letter in letters" ng-class="{enabled: addresses.filterAddresses(letter).length}"
                    ng-click="revealAddresses(letter)" reveal>
                    {{letter}}
                </li>
            </ol>
        </nav>
    </section>

    <section ng-controller=AddressCtrl>
        <div ng-show="initialized" class="animate-show">
            <div ng-show="addresses.addresses.length == 0 && state == 'home'" class="animate-show content">
                <p>
                    You don't have any addresses yet :(
                </p>
                <p ng-click="state = 'adding'">
                    Add Addresses Now
                </p>
            </div>
            <div ng-show="addresses.addresses.length && revealedAddresses.addresses.length == 0 && state == 'home'" class="animate-show content">
                <p>
                    Click on a letter to display the addresses and weather
                    for people whose last name starts with that letter.
                </p>
                <p ng-click="state = 'adding'">
                    Add More Addresses
                </p>
            </div>

            <div ng-show="revealedAddresses.addresses.length" class="animate-show content">
                <address ng-repeat="addr in revealedAddresses.addresses">
                    {{addr.firstName}}
                    {{addr.lastName}}
                    {{addr.address}}
                    <button ng-click="removeAddress(addr.wbID)">Remove this address</button>
                    <button ng-click="updateAddress(addr)">Update this address</button>
                </address>
            </div>

            <div ng-show="state == 'adding' && revealedAddresses.addresses.length == 0" ng-controller="AddressAddCtrl" class="animate-show content">
                <label>
                    <span>First Name</span>
                    <input type=text required ng-model=editingAddress.firstName>
                </label>
                <label>
                    <span>Last Name</span>
                    <input type=text required ng-model=editingAddress.lastName>
                </label>
                <label>
                    <span>Address</span>
                    <input type=text required ng-model=editingAddress.address>
                </label>
                <input type=hidden ng-model=editingAddress.wbID>
                <input type=submit ng-click="addAddress()">
            </div>
        </div>
    </section>
</div>

<script src=//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js></script>
<script src=//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.min.js></script>
<script src=//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-animate.js></script>
<script src=index.js></script>
